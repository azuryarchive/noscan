import got from 'got'
import formData from 'form-data'

export default async (stream: any) => {
  try {
    const form = new formData()
    form.append('file', stream)

    const { body } = await got.post('https://api.unscan.co/malware', {
      body: form
    })
    
    const data: any = JSON.parse(body)
    return data.infected
  } catch (err: any) {
    console.log(err.response.body)
  }
}